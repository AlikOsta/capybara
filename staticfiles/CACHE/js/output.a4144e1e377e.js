;(function(){const modal=new bootstrap.Modal(document.getElementById('modal'))
htmx.on('htmx:afterSwap',(e)=>{if(e.detail.target.id==='dialog')
modal.show()})
htmx.on('htmx:beforeSwap',(e)=>{if(e.detail.target.id==='dialog'&&!e.detail.xhr.response){modal.hide()
e.detail.shouldSwap=false}})
htmx.on('hidden.bs.modal',(e)=>{document.getElementById('dialog').innerHTML='';})})();document.addEventListener('DOMContentLoaded',()=>{const tg=window.Telegram&&window.Telegram.WebApp;if(tg){if(tg.BackButton)tg.BackButton.hide();tg.expand();tg.enableClosingConfirmation();adaptThemeToTelegram(tg);}
initImagePreview();initBackToTopButton();});function adaptThemeToTelegram(tg){if(!tg)return;const colorScheme=tg.colorScheme||'light';document.body.setAttribute('data-bs-theme',colorScheme);document.body.classList.add(`telegram-theme-${colorScheme}`);document.documentElement.style.setProperty('--tg-theme-bg-color',tg.themeParams.bg_color||'#ffffff');document.documentElement.style.setProperty('--tg-theme-text-color',tg.themeParams.text_color||'#000000');document.documentElement.style.setProperty('--tg-theme-hint-color',tg.themeParams.hint_color||'#999999');document.documentElement.style.setProperty('--tg-theme-link-color',tg.themeParams.link_color||'#2481cc');document.documentElement.style.setProperty('--tg-theme-button-color',tg.themeParams.button_color||'#2481cc');document.documentElement.style.setProperty('--tg-theme-button-text-color',tg.themeParams.button_text_color||'#ffffff');document.documentElement.style.setProperty('--tg-theme-secondary-bg-color',tg.themeParams.secondary_bg_color||'#f0f0f0');}
function initImagePreview(){const fileInput=document.querySelector('input[type="file"]');const previewContainer=document.querySelector('.image-preview-container');if(fileInput&&previewContainer){fileInput.addEventListener('change',function(){if(this.files&&this.files[0]){const reader=new FileReader();reader.onload=function(e){const placeholder=previewContainer.querySelector('.img-preview-placeholder');if(placeholder){placeholder.remove();}
let imgPreview=previewContainer.querySelector('.img-preview');if(!imgPreview){imgPreview=document.createElement('img');imgPreview.classList.add('img-preview','img-fluid','rounded');previewContainer.appendChild(imgPreview);}
imgPreview.src=e.target.result;imgPreview.alt='Предпросмотр';};reader.readAsDataURL(this.files[0]);}});}}
function initBackToTopButton(){const backToTopButton=document.getElementById('back-to-top');if(backToTopButton){window.addEventListener('scroll',function(){if(window.pageYOffset>300){backToTopButton.style.display='block';}else{backToTopButton.style.display='none';}});backToTopButton.addEventListener('click',function(){window.scrollTo({top:0,behavior:'smooth'});});}};